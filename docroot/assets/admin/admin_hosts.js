var loader=new YAHOO.util.YUILoader({base:"../../lib/f/yui/2/",loadOptional:false,require:["json","datatable","dom"],onSuccess:function(){YAHOO.util.Event.onDOMReady(function(){var b=this;b.selectedRow=null;b.width=$("#main").outerWidth();var e=function(i,h,j,k){$(i).html('<a href="../../status/hosts/detail?id='+h.getData("id")+'">'+YAHOO.lang.escapeHTML(k)+"</a>")};var f=function(i,h,j,k){$(i).html('<span class="remove-button"></span>')};var g=[{key:"hostname",label:"Host",sortable:true,formatter:e,width:350},{key:"ipaddr",label:"Address",sortable:true,formatter:"text",minWidth:100},{key:"status",label:"Status",sortable:true,formatter:"text"},{key:"monitversion",label:"Monit",sortable:true,formatter:"text"},{key:"description",label:"Description",sortable:false,formatter:"text",minWidth:200}];if(!ISTABLET){g.push({key:"delete",label:"",sortable:false,formatter:f})}var c=[{key:"hostname",label:"Host",sortable:true,formatter:"text",minWidth:200}];b.myDataSource=new YAHOO.util.XHRDataSource("../../admin/hosts/list");b.myDataSource.responseType=YAHOO.util.XHRDataSource.TYPE_JSON;b.myDataSource.responseSchema={resultsList:"records",fields:["id","hostname","ipaddr","description","monitversion","status"],metaFields:{totalRecords:"totalRecords"}};var d={selectionMode:"single",sortedBy:{key:"hostname",dir:YAHOO.widget.DataTable.CLASS_ASC}};b.myDataTable=new YAHOO.widget.DataTable("hostTable",b.width<768?c:g,b.myDataSource,d);b.myDataTable.subscribe("renderEvent",function(h){b.myDataTable.sortColumn(b.myDataTable.getColumn("hostname"),YAHOO.widget.DataTable.CLASS_ASC);b.myDataTable.unsubscribe("renderEvent");b.myDataTable.subscribe("renderEvent",function(i){$("#numHosts").text(b.myDataTable.getRecordSet().getLength())})});if(!(ISPHONE||ISTABLET)){b.myDataTable.subscribe("rowMouseoverEvent",function(h){var i=b.myDataTable.getRecord(h.target);if(i){b.myDataTable.highlightRow(i);$("#"+h.target.id+" .yui-dt-col-delete .remove-button").css("visibility","visible")}});b.myDataTable.subscribe("rowMouseoutEvent",function(h){var i=b.myDataTable.getRecord(h.target);if(i){b.myDataTable.unhighlightRow(i);$("#"+h.target.id+" .yui-dt-col-delete .remove-button").css("visibility","hidden")}})}b.myDataTable.subscribe("rowClickEvent",function(h){window.location="edit?id="+b.myDataTable.getRecord(h.target).getData("id")});b.myDataTable.subscribe("cellClickEvent",function(h){b.selectedRow=b.myDataTable.getRecord(h.target);if(b.myDataTable.getColumn(h.target).key=="delete"){$("#confirmDelete .text-error").text(b.selectedRow.getData("hostname"));$("#confirmDelete").modal("show");return false}});MMONIT.datatable.search.client(b.myDataTable,"hostname","searchField");$("#deletebtn").click(function(h){var i="id="+b.selectedRow.getData("id");$.post("delete",i,function(){b.myDataTable.deleteRow(b.selectedRow)}).fail(MMONIT.error.json)});$("#more").click(function(h){$("#more").hide();$("#moretext").show();return false});(function a(){b.width=$("#main").outerWidth();if(b.width<768){b.myDataTable.setColumnWidth(b.myDataTable.getColumn("hostname"),b.width-24)}else{var h=b.width-350;b.myDataTable.setColumnWidth(b.myDataTable.getColumn("hostname"),h/2);b.myDataTable.setColumnWidth(b.myDataTable.getColumn("description"),h/2)}$(window).off("resize orientationchange").on("resize orientationchange",a)})()})}});loader.insert();